/**
 * @return {?}
 */
var IASCallbacks = function() {
  return this.list = [], this.fireStack = [], this.isFiring = false, this.isDisabled = false, this.fire = function(args) {
    var parent = args[0];
    var next = args[1];
    var docs = args[2];
    /** @type {boolean} */
    this.isFiring = true;
    /** @type {number} */
    var index = 0;
    var length = this.list.length;
    for (;length > index;index++) {
      if (false === this.list[index].fn.apply(parent, docs)) {
        next.reject();
        break;
      }
    }
    /** @type {boolean} */
    this.isFiring = false;
    next.resolve();
    if (this.fireStack.length) {
      this.fire(this.fireStack.shift());
    }
  }, this.inList = function(handler, list) {
    list = list || 0;
    /** @type {number} */
    var i = list;
    var l = this.list.length;
    for (;l > i;i++) {
      if (this.list[i].fn === handler || handler.guid && (this.list[i].fn.guid && handler.guid === this.list[i].fn.guid)) {
        return i;
      }
    }
    return-1;
  }, this;
};
IASCallbacks.prototype = {
  /**
   * @param {Function} fn
   * @param {number} priority
   * @return {?}
   */
  add : function(fn, priority) {
    var callbackObject = {
      /** @type {Function} */
      fn : fn,
      priority : priority
    };
    priority = priority || 0;
    /** @type {number} */
    var index = 0;
    var length = this.list.length;
    for (;length > index;index++) {
      if (priority > this.list[index].priority) {
        return this.list.splice(index, 0, callbackObject), this;
      }
    }
    return this.list.push(callbackObject), this;
  },
  /**
   * @param {Function} callback
   * @return {?}
   */
  remove : function(callback) {
    /** @type {number} */
    var index = 0;
    for (;(index = this.inList(callback, index)) > -1;) {
      this.list.splice(index, 1);
    }
    return this;
  },
  /**
   * @param {Function} fn
   * @return {?}
   */
  has : function(fn) {
    return this.inList(fn) > -1;
  },
  /**
   * @param {?} context
   * @param {Array} args
   * @return {?}
   */
  fireWith : function(context, args) {
    var params = $.Deferred();
    return this.isDisabled ? params.reject() : (args = args || [], args = [context, params, args.slice ? args.slice() : args], this.isFiring ? this.fireStack.push(args) : this.fire(args), params);
  },
  /**
   * @return {undefined}
   */
  disable : function() {
    /** @type {boolean} */
    this.isDisabled = true;
  },
  /**
   * @return {undefined}
   */
  enable : function() {
    /** @type {boolean} */
    this.isDisabled = false;
  }
}, function($) {
  /** @type {number} */
  var b = -1;
  /**
   * @param {Object} $element
   * @param {Object} options
   * @return {?}
   */
  var IAS = function($element, options) {
    return this.itemsContainerSelector = options.container, this.itemSelector = options.item, this.nextSelector = options.next, this.paginationSelector = options.pagination, this.$scrollContainer = $element, this.$itemsContainer = $(this.itemsContainerSelector), this.$container = window === $element.get(0) ? $(document) : $element, this.defaultDelay = options.delay, this.negativeMargin = options.negativeMargin, this.nextUrl = null, this.isBound = false, this.listeners = {
      next : new IASCallbacks,
      load : new IASCallbacks,
      loaded : new IASCallbacks,
      render : new IASCallbacks,
      rendered : new IASCallbacks,
      scroll : new IASCallbacks,
      noneLeft : new IASCallbacks,
      ready : new IASCallbacks
    }, this.extensions = [], this.scrollHandler = function() {
      var currentScrollOffset = this.getCurrentScrollOffset(this.$scrollContainer);
      var scrollThreshold = this.getScrollThreshold();
      if (this.isBound) {
        if (b != scrollThreshold) {
          this.fire("scroll", [currentScrollOffset, scrollThreshold]);
          if (currentScrollOffset >= scrollThreshold) {
            this.next();
          }
        }
      }
    }, this.getLastItem = function() {
      return $(this.itemSelector, this.$itemsContainer.get(0)).last();
    }, this.getFirstItem = function() {
      return $(this.itemSelector, this.$itemsContainer.get(0)).first();
    }, this.getScrollThreshold = function(negativeMargin) {
      var $lastElement;
      return negativeMargin = negativeMargin || this.negativeMargin, negativeMargin = negativeMargin >= 0 ? -1 * negativeMargin : negativeMargin, $lastElement = this.getLastItem(), 0 === $lastElement.size() ? b : $lastElement.offset().top + $lastElement.height() + negativeMargin;
    }, this.getCurrentScrollOffset = function($container) {
      /** @type {number} */
      var inner = 0;
      var arr = $container.height();
      return inner = window === $container.get(0) ? $container.scrollTop() : $container.offset().top, (-1 != navigator.platform.indexOf("iPhone") || -1 != navigator.platform.indexOf("iPod")) && (arr += 80), inner + arr;
    }, this.getNextUrl = function(container) {
      return container || (container = this.$container), $(this.nextSelector, container).last().attr("href");
    }, this.load = function(uri, callback, delay) {
      var $itemContainer;
      var diff;
      var self = this;
      /** @type {Array} */
      var items = [];
      /** @type {number} */
      var aux = +new Date;
      delay = delay || this.defaultDelay;
      var data = {
        url : uri
      };
      return self.fire("load", [data]), $.get(data.url, null, $.proxy(function(data) {
        $itemContainer = $(this.itemsContainerSelector, data).eq(0);
        if (0 === $itemContainer.length) {
          $itemContainer = $(data).filter(this.itemsContainerSelector).eq(0);
        }
        if ($itemContainer) {
          $itemContainer.find(this.itemSelector).each(function() {
            items.push(this);
          });
        }
        self.fire("loaded", [data, items]);
        if (callback) {
          /** @type {number} */
          diff = +new Date - aux;
          if (delay > diff) {
            setTimeout(function() {
              callback.call(self, data, items);
            }, delay - diff);
          } else {
            callback.call(self, data, items);
          }
        }
      }, self), "html");
    }, this.render = function(items, canvas) {
      var self = this;
      var $lastItem = this.getLastItem();
      /** @type {number} */
      var count = 0;
      var event = this.fire("render", [items]);
      event.done(function() {
        $(items).hide();
        $lastItem.after(items);
        $(items).fadeIn(400, function() {
          if (!(++count < items.length)) {
            self.fire("rendered", [items]);
            if (canvas) {
              canvas();
            }
          }
        });
      });
    }, this.hidePagination = function() {
      if (this.paginationSelector) {
        $(this.paginationSelector, this.$container).hide();
      }
    }, this.restorePagination = function() {
      if (this.paginationSelector) {
        $(this.paginationSelector, this.$container).show();
      }
    }, this.throttle = function(fn, delay) {
      var g;
      var timer;
      /** @type {number} */
      var lastAnimationTime = 0;
      return g = function() {
        /**
         * @return {undefined}
         */
        function f() {
          /** @type {number} */
          lastAnimationTime = +new Date;
          fn.apply(that, newArgs);
        }
        var that = this;
        /** @type {Arguments} */
        var newArgs = arguments;
        /** @type {number} */
        var timeDiff = +new Date - lastAnimationTime;
        if (timer) {
          clearTimeout(timer);
        } else {
          f();
        }
        if (timeDiff > delay) {
          f();
        } else {
          /** @type {number} */
          timer = setTimeout(f, delay);
        }
      }, $.guid && (g.guid = fn.guid = fn.guid || $.guid++), g;
    }, this.fire = function(event, args) {
      return this.listeners[event].fireWith(this, args);
    }, this;
  };
  /**
   * @return {?}
   */
  IAS.prototype.initialize = function() {
    var currentScrollOffset = this.getCurrentScrollOffset(this.$scrollContainer);
    var scrollThreshold = this.getScrollThreshold();
    this.hidePagination();
    this.bind();
    /** @type {number} */
    var i = 0;
    var l = this.extensions.length;
    for (;l > i;i++) {
      this.extensions[i].bind(this);
    }
    return this.fire("ready"), this.nextUrl = this.getNextUrl(), currentScrollOffset >= scrollThreshold && this.next(), this;
  };
  /**
   * @return {undefined}
   */
  IAS.prototype.bind = function() {
    if (!this.isBound) {
      this.$scrollContainer.on("scroll", $.proxy(this.throttle(this.scrollHandler, 150), this));
      /** @type {boolean} */
      this.isBound = true;
    }
  };
  /**
   * @return {undefined}
   */
  IAS.prototype.unbind = function() {
    if (this.isBound) {
      this.$scrollContainer.off("scroll", this.scrollHandler);
      /** @type {boolean} */
      this.isBound = false;
    }
  };
  /**
   * @return {undefined}
   */
  IAS.prototype.destroy = function() {
    this.unbind();
  };
  /**
   * @param {string} event
   * @param {Function} callback
   * @param {number} priority
   * @return {?}
   */
  IAS.prototype.on = function(event, callback, priority) {
    if ("undefined" == typeof this.listeners[event]) {
      throw new Error('There is no event called "' + event + '"');
    }
    return priority = priority || 0, this.listeners[event].add($.proxy(callback, this), priority), this;
  };
  /**
   * @param {string} types
   * @param {Function} selector
   * @return {?}
   */
  IAS.prototype.one = function(types, selector) {
    var self = this;
    /**
     * @return {undefined}
     */
    var once = function() {
      self.off(types, selector);
      self.off(types, once);
    };
    return this.on(types, selector), this.on(types, once), this;
  };
  /**
   * @param {string} key
   * @param {Function} callback
   * @return {?}
   */
  IAS.prototype.off = function(key, callback) {
    if ("undefined" == typeof this.listeners[key]) {
      throw new Error('There is no event called "' + key + '"');
    }
    return this.listeners[key].remove(callback), this;
  };
  /**
   * @return {?}
   */
  IAS.prototype.next = function() {
    var url = this.nextUrl;
    var self = this;
    if (this.unbind(), !url) {
      return this.fire("noneLeft", [this.getLastItem()]), this.listeners.noneLeft.disable(), self.bind(), false;
    }
    var promise = this.fire("next", [url]);
    return promise.done(function() {
      self.load(url, function(data, arg) {
        self.render(arg, function() {
          self.nextUrl = self.getNextUrl(data);
          self.bind();
        });
      });
    }), promise.fail(function() {
      self.bind();
    }), true;
  };
  /**
   * @param {Object} extension
   * @return {?}
   */
  IAS.prototype.extension = function(extension) {
    if ("undefined" == typeof extension.bind) {
      throw new Error('Extension doesn\'t have required method "bind"');
    }
    return "undefined" != typeof extension.initialize && extension.initialize(this), this.extensions.push(extension), this;
  };
  /**
   * @return {?}
   */
  $.ias = function() {
    var $window = $(window);
    return $window.ias.apply($window, arguments);
  };
  /**
   * @param {string} option
   * @return {?}
   */
  $.fn.ias = function(option) {
    /** @type {Array.<?>} */
    var args = Array.prototype.slice.call(arguments);
    var retval = this;
    return this.each(function() {
      var $this = $(this);
      var data = $this.data("ias");
      var options = $.extend({}, $.fn.ias.defaults, $this.data(), "object" == typeof option && option);
      if (data || ($this.data("ias", data = new IAS($this, options)), $(document).ready($.proxy(data.initialize, data))), "string" == typeof option) {
        if ("function" != typeof data[option]) {
          throw new Error('There is no method called "' + option + '"');
        }
        args.shift();
        data[option].apply(data, args);
        if ("destroy" === option) {
          $this.data("ias", null);
        }
      }
      retval = $this.data("ias");
    }), retval;
  };
  $.fn.ias.defaults = {
    item : ".item",
    container : ".listing",
    next : ".next",
    pagination : false,
    delay : 600,
    negativeMargin : 10
  };
}(jQuery);
/**
 * @param {Object} options
 * @return {?}
 */
var IASHistoryExtension = function(options) {
  return options = $.extend({}, this.defaults, options), this.ias = null, this.prevSelector = options.prev, this.prevUrl = null, this.listeners = {
    prev : new IASCallbacks
  }, this.onPageChange = function(pageNum, scrollOffset, url) {
    var state = {};
    if (window.history) {
      if (window.history.replaceState) {
        history.replaceState(state, document.title, url);
      }
    }
  }, this.onScroll = function(y) {
    var x = this.getScrollThresholdFirstItem();
    if (this.prevUrl) {
      y -= this.ias.$scrollContainer.height();
      if (x >= y) {
        this.prev();
      }
    }
  }, this.getPrevUrl = function(container) {
    return container || (container = this.ias.$container), $(this.prevSelector, container).last().attr("href");
  }, this.getScrollThresholdFirstItem = function() {
    var q;
    return q = this.ias.getFirstItem(), 0 === q.size() ? -1 : q.offset().top;
  }, this.renderBefore = function(items, callback) {
    var ias = this.ias;
    var res = ias.getFirstItem();
    /** @type {number} */
    var count = 0;
    ias.fire("render", [items]);
    $(items).hide();
    res.before(items);
    $(items).fadeIn(400, function() {
      if (!(++count < items.length)) {
        ias.fire("rendered", [items]);
        if (callback) {
          callback();
        }
      }
    });
  }, this;
};
IASHistoryExtension.prototype.initialize = function(ias) {
  var secondChildren = this;
  /** @type {Object} */
  this.ias = ias;
  jQuery.extend(ias.listeners, this.listeners);
  /**
   * @return {?}
   */
  ias.prev = function() {
    return secondChildren.prev();
  };
  this.prevUrl = this.getPrevUrl();
}, IASHistoryExtension.prototype.bind = function(ias) {
  var self = this;
  ias.on("pageChange", $.proxy(this.onPageChange, this));
  ias.on("scroll", $.proxy(this.onScroll, this));
  ias.on("ready", function() {
    var yDelta = ias.getCurrentScrollOffset(ias.$scrollContainer);
    var xDelta = self.getScrollThresholdFirstItem();
    yDelta -= ias.$scrollContainer.height();
    if (xDelta >= yDelta) {
      self.prev();
    }
  });
}, IASHistoryExtension.prototype.prev = function() {
  var url = this.prevUrl;
  var self = this;
  var ias = this.ias;
  if (!url) {
    return false;
  }
  ias.unbind();
  var promise = ias.fire("prev", [url]);
  return promise.done(function() {
    ias.load(url, function(data, items) {
      self.renderBefore(items, function() {
        self.prevUrl = self.getPrevUrl(data);
        ias.bind();
        if (self.prevUrl) {
          self.prev();
        }
      });
    });
  }), promise.fail(function() {
    ias.bind();
  }), true;
}, IASHistoryExtension.prototype.defaults = {
  prev : ".prev"
};
/**
 * @param {Object} options
 * @return {?}
 */
var IASNoneLeftExtension = function(options) {
  return options = $.extend({}, this.defaults, options), this.ias = null, this.uid = (new Date).getTime(), this.html = options.html.replace("{text}", options.text), this.showNoneLeft = function() {
    var $spinner = $(this.html).attr("id", "ias_noneleft_" + this.uid);
    var $lastItem = this.ias.getLastItem();
    $lastItem.after($spinner);
    $spinner.fadeIn();
  }, this;
};
IASNoneLeftExtension.prototype.bind = function(ias) {
  /** @type {Object} */
  this.ias = ias;
  ias.on("noneLeft", $.proxy(this.showNoneLeft, this));
}, IASNoneLeftExtension.prototype.defaults = {
  text : "You reached the end.",
  html : '<div class="ias-noneleft" style="text-align: center;">{text}</div>'
};
/**
 * @return {?}
 */
var IASPagingExtension = function() {
  return this.ias = null, this.pagebreaks = [[0, document.location.toString()]], this.lastPageNum = 1, this.enabled = true, this.listeners = {
    pageChange : new IASCallbacks
  }, this.onScroll = function(currentScrollOffset) {
    if (this.enabled) {
      var urlPage;
      var ias = this.ias;
      var currentPageNum = this.getCurrentPageNum(currentScrollOffset);
      var currentPagebreak = this.getCurrentPagebreak(currentScrollOffset);
      if (this.lastPageNum !== currentPageNum) {
        urlPage = currentPagebreak[1];
        ias.fire("pageChange", [currentPageNum, currentScrollOffset, urlPage]);
      }
      this.lastPageNum = currentPageNum;
    }
  }, this.onNext = function(url) {
    var currentScrollOffset = this.ias.getCurrentScrollOffset(this.ias.$scrollContainer);
    this.pagebreaks.push([currentScrollOffset, url]);
    var currentPageNum = this.getCurrentPageNum(currentScrollOffset) + 1;
    this.ias.fire("pageChange", [currentPageNum, currentScrollOffset, url]);
    this.lastPageNum = currentPageNum;
  }, this.onPrev = function(url) {
    var self = this;
    var ias = self.ias;
    var currentScrollOffset = ias.getCurrentScrollOffset(ias.$scrollContainer);
    /** @type {number} */
    var prevCurrentScrollOffset = currentScrollOffset - ias.$scrollContainer.height();
    var pos0 = ias.getFirstItem();
    /** @type {boolean} */
    this.enabled = false;
    this.pagebreaks.unshift([0, url]);
    ias.one("rendered", function() {
      /** @type {number} */
      var i = 1;
      var l = self.pagebreaks.length;
      for (;l > i;i++) {
        self.pagebreaks[i][0] = self.pagebreaks[i][0] + pos0.offset().top;
      }
      var currentPageNum = self.getCurrentPageNum(prevCurrentScrollOffset) + 1;
      ias.fire("pageChange", [currentPageNum, prevCurrentScrollOffset, url]);
      self.lastPageNum = currentPageNum;
      /** @type {boolean} */
      self.enabled = true;
    });
  }, this;
};
IASPagingExtension.prototype.initialize = function(ias) {
  /** @type {Object} */
  this.ias = ias;
  jQuery.extend(ias.listeners, this.listeners);
}, IASPagingExtension.prototype.bind = function(ias) {
  try {
    ias.on("prev", $.proxy(this.onPrev, this), this.priority);
  } catch (b) {
  }
  ias.on("next", $.proxy(this.onNext, this), this.priority);
  ias.on("scroll", $.proxy(this.onScroll, this), this.priority);
}, IASPagingExtension.prototype.getCurrentPageNum = function(scrollOffset) {
  /** @type {number} */
  var i = this.pagebreaks.length - 1;
  for (;i > 0;i--) {
    if (scrollOffset > this.pagebreaks[i][0]) {
      return i + 1;
    }
  }
  return 1;
}, IASPagingExtension.prototype.getCurrentPagebreak = function(scrollOffset) {
  /** @type {number} */
  var i = this.pagebreaks.length - 1;
  for (;i >= 0;i--) {
    if (scrollOffset > this.pagebreaks[i][0]) {
      return this.pagebreaks[i];
    }
  }
  return null;
}, IASPagingExtension.prototype.priority = 500;
/**
 * @param {Object} options
 * @return {?}
 */
var IASSpinnerExtension = function(options) {
  return options = $.extend({}, this.defaults, options), this.ias = null, this.uid = (new Date).getTime(), this.src = options.src, this.html = options.html.replace("{src}", this.src), this.showSpinner = function() {
    var $help = this.getSpinner() || this.createSpinner();
    var $element = this.ias.getLastItem();
    $element.after($help);
    $help.fadeIn();
  }, this.showSpinnerBefore = function() {
    var o = this.getSpinner() || this.createSpinner();
    var exp = this.ias.getFirstItem();
    exp.before(o);
    o.fadeIn();
  }, this.removeSpinner = function() {
    if (this.hasSpinner()) {
      this.getSpinner().remove();
    }
  }, this.getSpinner = function() {
    var stat = $("#ias_spinner_" + this.uid);
    return stat.size() > 0 ? stat : false;
  }, this.hasSpinner = function() {
    var stat = $("#ias_spinner_" + this.uid);
    return stat.size() > 0;
  }, this.createSpinner = function() {
    var targetNode = $(this.html).attr("id", "ias_spinner_" + this.uid);
    return targetNode.hide(), targetNode;
  }, this;
};
IASSpinnerExtension.prototype.bind = function(ias) {
  /** @type {Object} */
  this.ias = ias;
  ias.on("next", $.proxy(this.showSpinner, this));
  try {
    ias.on("prev", $.proxy(this.showSpinnerBefore, this));
  } catch (b) {
  }
  ias.on("render", $.proxy(this.removeSpinner, this));
}, IASSpinnerExtension.prototype.defaults = {
  src : "data:image/gif;base64,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",
  html : '<div class="ias-spinner" style="text-align: center;"></div>'
};
/**
 * @param {Object} options
 * @return {?}
 */
var IASTriggerExtension = function(options) {
  return options = $.extend({}, this.defaults, options), this.ias = null, this.html = options.html.replace("{text}", options.text), this.enabled = true, this.count = 0, this.offset = options.offset, this.$triggerNext = null, this.$triggerPrev = null, this.showTriggerNext = function() {
    if (!this.enabled) {
      return true;
    }
    if (false === this.offset || ++this.count < this.offset) {
      return true;
    }
    var $trigger = this.$triggerNext || (this.$triggerNext = this.createTrigger(this.next));
    var $lastItem = this.ias.getLastItem();
    return $lastItem.after($trigger), $trigger.fadeIn(), false;
  }, this.showTriggerPrev = function() {
    if (!this.enabled) {
      return true;
    }
    var $trigger = this.$triggerPrev || (this.$triggerPrev = this.createTrigger(this.prev));
    var $firstItem = this.ias.getFirstItem();
    return $firstItem.before($trigger), $trigger.fadeIn(), false;
  }, this.createTrigger = function(clickCallback) {
    /** @type {number} */
    var uid = (new Date).getTime();
    var $trigger = $(this.html).attr("id", "ias_trigger_" + uid);
    return $trigger.hide(), $trigger.on("click", $.proxy(clickCallback, this)), $trigger;
  }, this;
};
IASTriggerExtension.prototype.bind = function(ias) {
  var options = this;
  /** @type {Object} */
  this.ias = ias;
  try {
    ias.on("prev", $.proxy(this.showTriggerPrev, this), this.priority);
  } catch (c) {
  }
  ias.on("next", $.proxy(this.showTriggerNext, this), this.priority);
  ias.on("rendered", function() {
    /** @type {boolean} */
    options.enabled = true;
  }, this.priority);
}, IASTriggerExtension.prototype.next = function() {
  /** @type {boolean} */
  this.enabled = false;
  this.ias.unbind();
  if (this.$triggerNext) {
    this.$triggerNext.remove();
    /** @type {null} */
    this.$triggerNext = null;
  }
  this.ias.next();
}, IASTriggerExtension.prototype.prev = function() {
  /** @type {boolean} */
  this.enabled = false;
  this.ias.unbind();
  if (this.$triggerPrev) {
    this.$triggerPrev.remove();
    /** @type {null} */
    this.$triggerPrev = null;
  }
  this.ias.prev();
}, IASTriggerExtension.prototype.defaults = {
  text : "Load more items",
  html : '<div class="ias-trigger" style="text-align: center; cursor: pointer;"><a>{text}</a></div>',
  offset : 0
}, IASTriggerExtension.prototype.priority = 1E3;
